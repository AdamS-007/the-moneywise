<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Inventory Asset Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/lumen/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        /* General Layout */
        body { font-family: 'Roboto', sans-serif; background-color: #f4f7f6; }
        .container-fluid { padding: 40px 30px; }

        /* Results Card */
        .search-results-card {
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-radius: 8px;
            overflow: hidden;
        }

        .card-header {
            background-color: #3b82f6; /* Modern Blue */
            color: white;
            padding: 12px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
        }

        /* Table Column Alignment Fix */
        .table { width: 100%; margin-bottom: 0; background: white; table-layout: fixed; } /* Fixed layout prevents squishing */

        .table thead th {
            background-color: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
            color: #64748b;
            font-size: 0.75rem;
            text-transform: uppercase;
            padding: 15px;
            text-align: left;
        }

        .table tbody td {
            padding: 15px;
            border-bottom: 1px solid #f1f5f9; /* Subtle separation lines */
            vertical-align: middle;
            font-size: 0.85rem;
            color: #334155;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis; /* Adds '...' if text is too long */
        }

        /* Column-Specific Widths */
        th:nth-child(1), td:nth-child(1) { width: 60px; }  /* ID */
        th:nth-child(2), td:nth-child(2) { width: 140px; } /* Asset Type */
        th:nth-child(3), td:nth-child(3) { width: 180px; } /* Product */
        th:nth-child(4), td:nth-child(4) { width: 150px; } /* Name */
        th:nth-child(5), td:nth-child(5) { width: 250px; } /* Serial Number */
        th:nth-child(6), td:nth-child(6) { width: 220px; } /* Email */
        th:nth-child(7), td:nth-child(7) { width: 100px; } /* Location */
        th:nth-child(8), td:nth-child(8) { width: 80px; }  /* Actions */

        .table tbody tr:hover { background-color: #f8fbff; }

        .btn-edit {
            background-color: #0ea5e9;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        {% if message %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endif %}

        <div class="row align-items-center mb-4">
            <div class="col-md-6">
                <h1 class="page-header mb-0" style="border-bottom: none;">Asset Management</h1>
            </div>
            <div class="col-md-6 text-end btn-action-group">
                <a href="{{ url_for('add_asset') }}" class="btn btn-success">âž• Add New</a>
                <a href="{{ url_for('add_bulk') }}" class="btn btn-outline-primary">ðŸ“¦ Bulk Add</a>
                <a href="{{ url_for('export_assets') }}" class="btn btn-outline-success">ðŸ“¥ Export Excel</a>
            </div>
        </div>

        <form class="search-form" method="GET" action="/">
            <div class="input-group input-group-lg">
                <input
                    type="text"
                    class="form-control"
                    placeholder="Search serial, user, model, or department..."
                    name="query"
                    value="{{ query }}"
                >
                <button class="btn btn-info text-white" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                      <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.085.122l3.023 3.023a.75.75 0 0 0 1.06-1.06l-3.023-3.023q-.062-.04-.122-.085zM6.5 11a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9"/>
                    </svg>
                    &nbsp;Search
                </button>
            </div>

            <div class="form-text mt-3">
                {% if query %}
                    Found <strong>{{ result_count }}</strong> matches for: <span class="badge bg-light text-dark">"{{ query }}"</span>.
                {% else %}
                    Total Inventory: <strong>{{ result_count | int | default(0) | thousands_separator }}</strong> items.
                {% endif %}
            </div>
        </form>

        <div class="card search-results-card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>
                    {% if query %}
                        Results for "{{ query }}"
                    {% else %}
                        Recent Assets
                    {% endif %}
                </span>
                <small class="fw-light">Showing top results</small>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    {{ results_html | safe }}
                </div>
            </div>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>